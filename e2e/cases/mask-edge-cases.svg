<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
  <!-- Tests: Mask edge cases (9 subtests in 3x3 grid)
       Pass: all green squares visible, no red visible
       Each cell has green underneath, red on top with mask applied

       Row 1: 1) empty mask  2) visibility:hidden  3) display:none
       Row 2: 4) broken ref  5) opacity:0          6) fill:none stroke:none
       Row 3: 7) stroke-only 8) stroke-opacity:0   9) fill-opacity:0 -->

  <defs>
    <!-- 1. Empty mask → nothing visible -->
    <mask id="mask-empty"/>

    <!-- 2. visibility:hidden child → nothing visible -->
    <mask id="mask-hidden">
      <rect width="100" height="100" fill="white" visibility="hidden"/>
    </mask>

    <!-- 3. display:none child → nothing visible -->
    <mask id="mask-display-none">
      <rect width="100" height="100" fill="white" display="none"/>
    </mask>

    <!-- 4. (Broken reference tested inline - no mask def needed) -->

    <!-- 5. opacity:0 → nothing visible -->
    <mask id="mask-opacity-zero">
      <rect width="100" height="100" fill="white" opacity="0"/>
    </mask>

    <!-- 6. fill:none stroke:none → nothing visible -->
    <mask id="mask-no-fill-stroke">
      <rect width="100" height="100" fill="none" stroke="none"/>
    </mask>

    <!-- 7. stroke with stroke-width → partially visible (positive test) -->
    <mask id="mask-stroke-only">
      <rect x="8" y="8" width="12" height="12" fill="none" stroke="white" stroke-width="4"/>
    </mask>

    <!-- 8. stroke-opacity:0 → nothing visible -->
    <mask id="mask-stroke-opacity-zero">
      <rect x="8" y="8" width="12" height="12" fill="none" stroke="white" stroke-width="4" stroke-opacity="0"/>
    </mask>

    <!-- 9. fill-opacity:0 → nothing visible -->
    <mask id="mask-fill-opacity-zero">
      <rect width="100" height="100" fill="white" fill-opacity="0"/>
    </mask>
  </defs>

  <!-- 3x3 grid of tests, each 28x28 with 4px gap -->
  <!-- Row 1 -->
  <!-- Test 1: empty mask -->
  <g transform="translate(4, 4)">
    <rect width="28" height="28" fill="lime"/>
    <rect width="28" height="28" fill="red" mask="url(#mask-empty)"/>
  </g>

  <!-- Test 2: visibility:hidden -->
  <g transform="translate(36, 4)">
    <rect width="28" height="28" fill="lime"/>
    <rect width="28" height="28" fill="red" mask="url(#mask-hidden)"/>
  </g>

  <!-- Test 3: display:none -->
  <g transform="translate(68, 4)">
    <rect width="28" height="28" fill="lime"/>
    <rect width="28" height="28" fill="red" mask="url(#mask-display-none)"/>
  </g>

  <!-- Row 2 -->
  <!-- Test 4: broken reference (element should be visible, not masked) -->
  <g transform="translate(4, 36)">
    <rect width="28" height="28" fill="red"/>
    <rect width="28" height="28" fill="lime" mask="url(#mask-nonexistent)"/>
  </g>

  <!-- Test 5: opacity:0 -->
  <g transform="translate(36, 36)">
    <rect width="28" height="28" fill="lime"/>
    <rect width="28" height="28" fill="red" mask="url(#mask-opacity-zero)"/>
  </g>

  <!-- Test 6: fill:none stroke:none -->
  <g transform="translate(68, 36)">
    <rect width="28" height="28" fill="lime"/>
    <rect width="28" height="28" fill="red" mask="url(#mask-no-fill-stroke)"/>
  </g>

  <!-- Row 3 -->
  <!-- Test 7: stroke only (positive test - shows red ring through stroke area) -->
  <g transform="translate(4, 68)">
    <rect width="28" height="28" fill="lime"/>
    <rect width="28" height="28" fill="red" mask="url(#mask-stroke-only)"/>
    <!-- Cover the visible red with green to make pass = all green -->
    <rect x="6" y="6" width="16" height="16" fill="lime"/>
  </g>

  <!-- Test 8: stroke-opacity:0 -->
  <g transform="translate(36, 68)">
    <rect width="28" height="28" fill="lime"/>
    <rect width="28" height="28" fill="red" mask="url(#mask-stroke-opacity-zero)"/>
  </g>

  <!-- Test 9: fill-opacity:0 -->
  <g transform="translate(68, 68)">
    <rect width="28" height="28" fill="lime"/>
    <rect width="28" height="28" fill="red" mask="url(#mask-fill-opacity-zero)"/>
  </g>
</svg>
